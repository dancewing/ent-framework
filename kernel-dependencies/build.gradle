/*
 * This file was generated by the Gradle 'init' task.
 */

plugins {
    id 'java-platform' // 引入 java-platform插件
    id 'maven-publish' // 发布插件，可用来发布 BOM 或 jar到本地与远程仓库
}
// 通过这个配置可以让Gradle允许引入依赖，当然这是可选的
javaPlatform {
    allowDependencies()
}

dependencies {
    api(platform(project(':kernel-parent')))
    //在constraints块中定义依赖版本约束
    constraints{
        rootProject.subprojects.forEach {
            def file = new File("${it.getProjectDir().getAbsolutePath()}/build.gradle")
            if (file.exists() && it.name != 'kernel-parent' && it.name != 'kernel-dependencies') {
                api(project(it.path))
            }
        }
    }
}
publishing{
    publications{
        maven(MavenPublication) {
            //通过java-platform生成BOM
            from components.javaPlatform
        }
    }
    repositories {
        def host = project.version.endsWith( '-SNAPSHOT' )? mavenSnapshotRepository : mavenRealseRepository
        maven {
            allowInsecureProtocol = !host.startsWith('https')
            //指定要上传的maven私服仓库
            url = host
            //认证用户和密码
            credentials {
                username = mavenDeployUser
                password = mavenDeployPassword
            }
        }
    }
}

description = 'kernel-dependencies'
